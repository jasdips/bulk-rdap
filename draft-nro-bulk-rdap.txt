



Network Working Group                       Number Resource Organization
Internet-Draft                                               15 May 2024
Intended status: Standards Track                                        
Expires: 16 November 2024


                               Bulk RDAP
                         draft-nro-bulk-rdap-01

Abstract

   To complement the move from Whois to RDAP for the Regional Internet
   Registries (RIRs), this document specifies a new service, named the
   Bulk RDAP, that an RIR can deploy in lieu of its Bulk Whois service.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 16 November 2024.

Copyright Notice

   Copyright (c) 2024 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.






                        Expires 16 November 2024                [Page 1]

Internet-Draft                  bulk-rdap                       May 2024


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Requirements Language . . . . . . . . . . . . . . . . . .   2
   2.  Bulk Data Format  . . . . . . . . . . . . . . . . . . . . . .   3
     2.1.  Metadata  . . . . . . . . . . . . . . . . . . . . . . . .   3
     2.2.  Data  . . . . . . . . . . . . . . . . . . . . . . . . . .   3
     2.3.  Sample Bulk Data  . . . . . . . . . . . . . . . . . . . .   4
   3.  Extension Identifier  . . . . . . . . . . . . . . . . . . . .   7
   4.  Bulk RDAP URL . . . . . . . . . . . . . . . . . . . . . . . .   8
     4.1.  Content Types . . . . . . . . . . . . . . . . . . . . . .   8
   5.  Security Considerations . . . . . . . . . . . . . . . . . . .   9
   6.  Operational Considerations  . . . . . . . . . . . . . . . . .   9
   7.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   9
     7.1.  RDAP Extensions Registry  . . . . . . . . . . . . . . . .   9
   8.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  10
   9.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  10
     9.1.  Normative References  . . . . . . . . . . . . . . . . . .  10
     9.2.  Informative References  . . . . . . . . . . . . . . . . .  11
   Appendix A.  Other Potential Use Cases  . . . . . . . . . . . . .  11
     A.1.  Escrow  . . . . . . . . . . . . . . . . . . . . . . . . .  11
   Appendix B.  Change History . . . . . . . . . . . . . . . . . . .  11
     B.1.  Changes from 00 to 01 . . . . . . . . . . . . . . . . . .  11
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .  12

1.  Introduction

   As the RIRs shift from Whois to RDAP, they also need an RDAP
   counterpart for their Bulk Whois service.  To that end, this document
   specifies a new service, named the Bulk RDAP, that an RIR can deploy
   to replace the Bulk Whois.  This service is intended to be a simple,
   easy-to-implement replacement.

   At a higher level, the Bulk RDAP comprises JSON data for IP Network,
   Autonomous System Number, Domain, Nameserver, and Entity object
   classes (Section 5 of [RFC9083]), plus some JSON metadata.  It can be
   easily extended to include data for any future RDAP object class.
   Furthermore, it is an HTTPS-based service that the RIR customers can
   use to securely get this bulk data.

1.1.  Requirements Language

   The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.




                        Expires 16 November 2024                [Page 2]

Internet-Draft                  bulk-rdap                       May 2024


   Indentation and whitespace in examples are provided only to
   illustrate element relationships, and are not a REQUIRED feature of
   this service.

   "..." in examples is used as shorthand for elements defined outside
   of this document.

2.  Bulk Data Format

   The data returned for a Bulk RDAP request (Section 4) is a JSON
   object providing metadata information, followed by newline-separated
   data objects for one or more RDAP object classes (Section 5 of
   [RFC9083]).

2.1.  Metadata

   The JSON metadata object MUST include the following members:

   *  "extensionId" -- the "nroBulkRdap1" string (see Section 7.1)
   *  "versionId" -- a version 4 Universally Unique IDentifier (UUID,
      Section 5.4 of [RFC9562]) string that MUST be the same for all the
      bulk data generated for various RDAP object classes at a
      particular interval (say, on a particular day)
   *  "producer" -- a string identifying the registry that produced the
      bulk data, with possible values of "AFRINIC", "APNIC", "ARIN",
      "LACNIC", "RIPE NCC", or an agreed-upon string literal for a
      registry at the national or local level
   *  "productionDate" -- a string containing the date and time with the
      UTC offset ([RFC3339]) of the producer, indicating when the bulk
      data being returned was produced
   *  "objectCount" -- a positive number (greater than 0) representing
      the count of newline-separated data objects following the metadata
      object, to help clients detect a partial response for a bulk data
      request

2.2.  Data

   The metadata object is followed by newline-separated data objects for
   one or more RDAP object classes.  Beside adhering to the object class
   definition per Section 5 of [RFC9083] or the specification of a
   future RDAP object class, each returned object has the following
   characteristics:

   *  An "rdapConformance" member (Section 4.1 of [RFC9083]) MUST be
      included to indicate the RDAP extensions used for constructing the
      object.





                        Expires 16 November 2024                [Page 3]

Internet-Draft                  bulk-rdap                       May 2024


   *  The "self" links (Section 4.2 of [RFC9083]) for the object and its
      first-level nested objects MUST be included.  For example, include
      the "self" links for an entity object (representing an
      organization) and its IP network and autonomous system number
      objects but not for the entities within those IP network and
      autonomous system number objects.
   *  For compactness, a first-level nested object MUST NOT include any
      other data beside its "self" link, "handle" (representing a
      registry-unique identifier for the object) if defined, and
      relationship to the containing object (e.g., using the "roles"
      member in a nested entity object to relate to its containing IP
      network object).

2.3.  Sample Bulk Data

   The following is an elided example of the bulk data generated on a
   particular day for the IP Network object class:

{
  "extensionId": "nroBulkRdap1",
  "versionId": "3f8183db-1de6-4304-a0b3-e8df6c7ff1f2",
  "producer": "ARIN",
  "productionDate": "2024-05-14T04:00:00-04:00"
  "objectCount": 500000
}
{
  "rdapConformance": [ "rdap_level_0", "nro_rdap_profile_0", "nroBulkRdap1", ... ],
  "objectClassName": "ip network",
  "handle": "XXXX-ARIN",
  "startAddress": "2001:db8::",
  "endAddress": "2001:db8:0:ffff:ffff:ffff:ffff:ffff",
  "ipVersion": "v6",
  ...
  "links":
  [
    {
      "value": "https://example.net/ip/2001:db8::/48",
      "rel": "self",
      "href": "https://example.net/ip/2001:db8::/48",
      "type": "application/rdap+json"
    },
    ...
  ],
  "entities":
  [
    {
      "objectClassName": "entity",
      "handle": "AAAA-ARIN",



                        Expires 16 November 2024                [Page 4]

Internet-Draft                  bulk-rdap                       May 2024


      "roles": [ "administrative", ... ]
      "links":
      [
        {
          "value": "https://example.net/ip/2001:db8::/48",
          "rel": "self",
          "href": "https://example.net/entity/AAAA-ARIN",
          "type": "application/rdap+json"
        }
      ],
    },
    ...
  ]
}
{
  "rdapConformance": [ "rdap_level_0", "nro_rdap_profile_0", "nroBulkRdap1", ... ],
  "objectClassName": "ip network",
  "handle": "YYYY-ARIN",
  "startAddress": "2001:db8:1::",
  "endAddress": "2001:db8:1:ffff:ffff:ffff:ffff:ffff",
  "ipVersion": "v6",
  ...
  "links":
  [
    {
      "value": "https://example.net/ip/2001:db8:1::/48",
      "rel": "self",
      "href": "https://example.net/ip/2001:db8:1::/48",
      "type": "application/rdap+json"
    },
    ...
  ],
  "entities":
  [
    {
      "objectClassName": "entity",
      "handle": "BBBB-ARIN",
      "roles": [ "technical", ... ]
      "links":
      [
        {
          "value": "https://example.net/ip/2001:db8:1::/48",
          "rel": "self",
          "href": "https://example.net/entity/BBBB-ARIN",
          "type": "application/rdap+json"
        }
      ],
    },



                        Expires 16 November 2024                [Page 5]

Internet-Draft                  bulk-rdap                       May 2024


    ...
  ]
}
...

   The following is an elided example of the bulk data generated on the
   same day for all the RDAP object classes an RIR supports:

{
  "extensionId": "nroBulkRdap1",
  "versionId": "3f8183db-1de6-4304-a0b3-e8df6c7ff1f2",
  "producer": "ARIN",
  "productionDate": "2024-05-14T04:30:00-04:00"
  "objectCount": 750000
}
{
  "rdapConformance": [ "rdap_level_0", "nro_rdap_profile_0", "nroBulkRdap1", ... ],
  "objectClassName": "ip network",
  "handle": "XXXX-ARIN",
  "startAddress": "2001:db8::",
  "endAddress": "2001:db8:0:ffff:ffff:ffff:ffff:ffff",
  "ipVersion": "v6",
  ...
  "links":
  [
    {
      "value": "https://example.net/ip/2001:db8::/48",
      "rel": "self",
      "href": "https://example.net/ip/2001:db8::/48",
      "type": "application/rdap+json"
    },
    ...
  ],
  "entities":
  [
    {
      "objectClassName": "entity",
      "handle": "AAAA-ARIN",
      "roles": [ "administrative", ... ]
      "links":
      [
        {
          "value": "https://example.net/ip/2001:db8::/48",
          "rel": "self",
          "href": "https://example.net/entity/AAAA-ARIN",
          "type": "application/rdap+json"
        }
      ],



                        Expires 16 November 2024                [Page 6]

Internet-Draft                  bulk-rdap                       May 2024


    },
    ...
  ]
}
...
{
  "rdapConformance": [ "rdap_level_0", "nro_rdap_profile_0", "nroBulkRdap1", ... ],
  "objectClassName": "autnum",
  "handle": "ZZZZ-ARIN",
  "startAutnum": 65536,
  "endAutnum": 65541,
  ...
  "links":
  [
    {
      "value": "https://example.net/autnum/65536",
      "rel": "self",
      "href": "https://example.net/autnum/65536",
      "type": "application/rdap+json"
    },
    ...
  ],
  "entities":
  [
    {
      "objectClassName": "entity",
      "handle": "BBBB-ARIN",
      "roles": [ "technical", ... ]
      "links":
      [
        {
          "value": "https://example.net/autnum/65536",
          "rel": "self",
          "href": "https://example.net/entity/BBBB-ARIN",
          "type": "application/rdap+json"
        }
      ],
    },
    ...
  ]
}
...

3.  Extension Identifier

   The "nroBulkRdap1" extension identifier (see Section 7.1) MUST be
   included as the value for the "extensionId" member in the metadata
   object of a bulk data response.



                        Expires 16 November 2024                [Page 7]

Internet-Draft                  bulk-rdap                       May 2024


   The "rdapConformance" array for each returned data object MUST
   include both the "nroBulkRdap1" extension identifier and the
   extension identifier for the NRO RDAP Profile ("nro_rdap_profile_0"
   as of this writing).  In the data objects, the Bulk RDAP extension
   requirements MUST supersede the NRO RDAP Profile extension
   requirements, primarily to afford bulk data compactness.

4.  Bulk RDAP URL

   *  Scheme: HTTPS
   *  Method: GET
   *  Path Segment: nroBulkRdap1?objectClass=<RDAP object class name>
   *  Returns: See Section 4.1

   The HTTPS scheme MUST be used for the Bulk RDAP URL.

   When the "objectClass" query parameter is present in the request URL,
   the bulk data response MUST be limited to all the objects for the
   RDAP object class listed in that query parameter.

   When the "objectClass" query parameter is absent in the request URL,
   the bulk data response MUST return all the objects for all the RDAP
   object classes the server supports.

   The following is an example URL to get bulk data for the IP Network
   object class:

   https://example.net/nroBulkRdap1?objectClass=ip%20network

   If the RDAP object class listed in the "objectClass" query parameter
   is valid (Section 5 of [RFC9083] or a future RDAP object class) but
   the bulk data functionality has not been implemented for it, the
   server SHOULD return a 501 Not Implemented response (Section 15.6.2
   of [RFC9110]).

   If the RDAP object class listed in the "objectClass" query parameter
   is invalid, the server SHOULD return a 400 Bad Request response
   (Section 15.5.1 of [RFC9110]).

   The following is an example URL to get bulk data for all the RDAP
   object classes an RIR supports:

   https://example.net/nroBulkRdap1

4.1.  Content Types

   The content type for a bulk data response can be:




                        Expires 16 November 2024                [Page 8]

Internet-Draft                  bulk-rdap                       May 2024


   *  "application/rdap+json" -- for a metadata JSON object followed by
      newline-separated RDAP objects
   *  "application/jose" -- for a JWS (JSON Web Signature) compact
      serialization (Section 3.1 of [RFC7515]) of the metadata and data
      objects (see Section 5)
   *  "application/json" -- for a JWS JSON serialization (Section 3.2 of
      [RFC7515]) of the metadata and data objects (see Section 5)
   *  "application/gzip" -- for a gzip ([RFC1952]) of either the
      metadata and data objects or their JWS

   It is RECOMMENDED that a bulk data response be returned as a gzip
   with "application/gzip" content type.

5.  Security Considerations

   It is RECOMMENDED that JSON Web Signature (JWS) [RFC7515] and JSON
   Web Key (JWK) [RFC7517] be used to sign and validate the JSON data
   returned for a Bulk RDAP response.  It is further RECOMMENDED that
   Elliptic Curve Digital Signature Algorithm (ECDSA) (Section 3.4 of
   [RFC7518]) be used for JWS.

   Furthermore, the guidance from Section 3 of [RFC7481] MUST be
   followed to secure the Bulk RDAP URL for authentication,
   authorization, and encryption.

6.  Operational Considerations

   If a server uses the JWS to secure bulk data, the related JWK is
   assumed to be distributed out-of-band to the clients.

   Since bulk data generation and optionally signing it are considered
   computationally expensive, it is RECOMMENDED that these operations be
   performed off-line and once a day.

7.  IANA Considerations

7.1.  RDAP Extensions Registry

   IANA is requested to register the following value in the RDAP
   Extensions Registry at https://www.iana.org/assignments/rdap-
   extensions/: (https://www.iana.org/assignments/rdap-extensions/:)

   *  Extension identifier: nroBulkRdap1
   *  Registry operator: Regional Internet Registries (RIRs), including
      at national and local levels.
   *  Published specification: This document.
   *  Contact: Number Resource Organization (NRO) secretariat@nro.net
      (mailto:secretariat@nro.net)



                        Expires 16 November 2024                [Page 9]

Internet-Draft                  bulk-rdap                       May 2024


   *  Intended usage: This NRO-level extension describes version 1 of a
      method to access registration data in bulk from the RIRs through
      RDAP.

8.  Acknowledgements

   The JSON Web Signature idea is borrowed from the RDAP Mirroring
   Protocol proposal ([I-D.harrison-regext-rdap-mirroring]).  In the
   metadata object, using a UUID for the "versionId" field is influenced
   by the RPKI Repository Delta Protocol (RRDP, [RFC8182]), and the
   "producer" and "productionDate" fields by the NRO Transfer Log
   Format.

9.  References

9.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC3339]  Klyne, G. and C. Newman, "Date and Time on the Internet:
              Timestamps", RFC 3339, DOI 10.17487/RFC3339, July 2002,
              <https://www.rfc-editor.org/info/rfc3339>.

   [RFC7481]  Hollenbeck, S. and N. Kong, "Security Services for the
              Registration Data Access Protocol (RDAP)", STD 95,
              RFC 7481, DOI 10.17487/RFC7481, March 2015,
              <https://www.rfc-editor.org/info/rfc7481>.

   [RFC7515]  Jones, M., Bradley, J., and N. Sakimura, "JSON Web
              Signature (JWS)", RFC 7515, DOI 10.17487/RFC7515, May
              2015, <https://www.rfc-editor.org/info/rfc7515>.

   [RFC7517]  Jones, M., "JSON Web Key (JWK)", RFC 7517,
              DOI 10.17487/RFC7517, May 2015,
              <https://www.rfc-editor.org/info/rfc7517>.

   [RFC7518]  Jones, M., "JSON Web Algorithms (JWA)", RFC 7518,
              DOI 10.17487/RFC7518, May 2015,
              <https://www.rfc-editor.org/info/rfc7518>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.





                        Expires 16 November 2024               [Page 10]

Internet-Draft                  bulk-rdap                       May 2024


   [RFC9083]  Hollenbeck, S. and A. Newton, "JSON Responses for the
              Registration Data Access Protocol (RDAP)", STD 95,
              RFC 9083, DOI 10.17487/RFC9083, June 2021,
              <https://www.rfc-editor.org/info/rfc9083>.

   [RFC9110]  Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke,
              Ed., "HTTP Semantics", STD 97, RFC 9110,
              DOI 10.17487/RFC9110, June 2022,
              <https://www.rfc-editor.org/info/rfc9110>.

   [RFC9562]  Davis, K., Peabody, B., and P. Leach, "Universally Unique
              IDentifiers (UUIDs)", RFC 9562, DOI 10.17487/RFC9562, May
              2024, <https://www.rfc-editor.org/info/rfc9562>.

9.2.  Informative References

   [I-D.harrison-regext-rdap-mirroring]
              Harrison, T., Michaelson, G. G., and A. Newton, "RDAP
              Mirroring Protocol (RMP)", Work in Progress, Internet-
              Draft, draft-harrison-regext-rdap-mirroring-00, 1 February
              2019, <https://datatracker.ietf.org/doc/html/draft-
              harrison-regext-rdap-mirroring-00>.

   [RFC1952]  Deutsch, P., "GZIP file format specification version 4.3",
              RFC 1952, DOI 10.17487/RFC1952, May 1996,
              <https://www.rfc-editor.org/info/rfc1952>.

   [RFC8182]  Bruijnzeels, T., Muravskiy, O., Weber, B., and R. Austein,
              "The RPKI Repository Delta Protocol (RRDP)", RFC 8182,
              DOI 10.17487/RFC8182, July 2017,
              <https://www.rfc-editor.org/info/rfc8182>.

Appendix A.  Other Potential Use Cases

A.1.  Escrow

   Although there is presently no requirement for the RIRs to escrow
   their registration data, the JSON data format described here could be
   used for that purpose in the future.

Appendix B.  Change History

B.1.  Changes from 00 to 01

   *  A bulk data response now comprises a metadata object followed by
      newline-separated RDAP data objects.





                        Expires 16 November 2024               [Page 11]

Internet-Draft                  bulk-rdap                       May 2024


   *  Updated the metadata object definition to include the
      "extensionId", "versionId" (in lieu of "serial"), "producer",
      "productionDate", and "objectCount" fields.
   *  Each RDAP data object now has its own "rdapConformance" member to
      indicate the RDAP extensions used for its construction.
   *  Clarified requirements for the data objects to help clients
      consume bulk data consistently across all the RIRs.
   *  No more mention of FTP since the HTTPS scheme is now a must.
   *  Can now get bulk data for all the RDAP object classes an RIR
      supports.
   *  Clarified available content types for the bulk data and identified
      the preferred one.
   *  Updated the Operational Considerations section for out-of-band JWK
      distribution and off-line, daily generation of bulk data.

Author's Address

   Number Resource Organization
   Email: secretariat@nro.net
































                        Expires 16 November 2024               [Page 12]
